{% extends 'base.html' %}
{% load static %}

{% block css %}
    <link href="{% static 'css/edit.css' %}" rel="stylesheet">
{% endblock %}

{% block js %}
    <script type="text/javascript" src="{% static 'js/edit.js' %}"></script>
{% endblock %}

{% block content %}
    {% if tasks %}
        <table>
            <tr>
                <th>Task</th>
            </tr>
            {% for task in tasks %}
                <tr>
                    <td id="{{ task.task_id }}" class="tableInfo">
                        <p>{{ task.name }}</p>
                        <p>{{ task.date }}</p>
                    </td>
                </tr>

                <div id="{{ task.task_id }}_modal" class="modal">
                    <div class="modalContent">
                        <span id="{{ task.task_id }}_close" class="closeModal">&times;</span>
                        <div class="buttons">
                            <a href="{% url 'taskpop:delete' task.task_id %}"><img class="buttonimg" src="{% static 'img/Trash.png' %}"></a>
                            <a href="{% url 'taskpop:blowup' task.task_id %}"><img src="{% static 'img/Bomb.png' %}"></a>
                        </div>
                        <div class="titleContainer"><h2 class="title">Edit Task</h2></div>
                        <form action="{% url 'taskpop:save' task.task_id %}" method="post">{% csrf_token %}
                            <label class="formLabel" for="task_name">Task Name</label>
                            <input class="modalInput" id="task_name" type="text" name="your_name" value="{{ task.name }}">
                            <label class="formLabel" for="task_date">Expected Deadline</label>
                            <input class="modalInput" id="task_date" type="datetime-local" name="task_date" value="{{ task.date }}">
                            <input class="submitModal" type="submit" value="Save">
                        </form>
                    </div>
                </div>
                <script>
                    $(function(){
                       $("#{{ task.task_id }}").click(function(event){
                          event.preventDefault();
                          var modal = document.getElementById("{{ task.task_id }}_modal");
                          modal.style.display = "block";
                          $("#{{ task.task_id }}_close").click(function(event){
                             modal.style.display = "none";
                          });
                       });
                    });
                </script>
            {% endfor %}
        </table>
    {% else %}
        <h1 class="title">You have no tasks available in your queue.</h1>
    {% endif %}
{% endblock %}